# Ù†Ø¸Ø§Ù… Ø§Ù„Ù…Ø±Ø§Ø³Ù„Ø© Ø§Ù„Ù…ÙˆØ­Ø¯ - Sooq Mazad

Ù†Ø¸Ø§Ù… Ù…Ø±Ø§Ø³Ù„Ø© Ù…ØªÙƒØ§Ù…Ù„ Ø¹Ù„Ù‰ Ø·Ø±Ø§Ø² ÙˆØ§ØªØ³Ø§Ø¨ ÙŠØ¯Ø¹Ù… Ø§Ù„Ø±Ø³Ø§Ø¦Ù„ Ø§Ù„Ù†ØµÙŠØ©ØŒ Ø§Ù„ØµÙˆØªÙŠØ©ØŒ ÙˆØ§Ù„Ù…ÙƒØ§Ù„Ù…Ø§Øª Ø§Ù„ØµÙˆØªÙŠØ© ÙˆØ§Ù„ÙÙŠØ¯ÙŠÙˆ.

## ğŸ“‹ Ø§Ù„Ù…Ø­ØªÙˆÙŠØ§Øª

1. [Ù†Ø¸Ø±Ø© Ø¹Ø§Ù…Ø©](#Ù†Ø¸Ø±Ø©-Ø¹Ø§Ù…Ø©)
2. [Ø§Ù„Ø¨Ù†ÙŠØ© ÙˆØ§Ù„Ù…Ù„ÙØ§Øª](#Ø§Ù„Ø¨Ù†ÙŠØ©-ÙˆØ§Ù„Ù…Ù„ÙØ§Øª)
3. [Ø·Ø±ÙŠÙ‚Ø© Ø§Ù„Ø§Ø³ØªØ®Ø¯Ø§Ù…](#Ø·Ø±ÙŠÙ‚Ø©-Ø§Ù„Ø§Ø³ØªØ®Ø¯Ø§Ù…)
4. [APIs Ø§Ù„Ù…ØªØ§Ø­Ø©](#apis-Ø§Ù„Ù…ØªØ§Ø­Ø©)
5. [Ø§Ù„Ù…ÙƒÙˆÙ†Ø§Øª](#Ø§Ù„Ù…ÙƒÙˆÙ†Ø§Øª)
6. [Ø§Ù„Ø®Ø¯Ù…Ø§Øª](#Ø§Ù„Ø®Ø¯Ù…Ø§Øª)
7. [Ù‚Ø§Ø¹Ø¯Ø© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª](#Ù‚Ø§Ø¹Ø¯Ø©-Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª)
8. [Ø£Ù…Ø«Ù„Ø© Ø¹Ù…Ù„ÙŠØ©](#Ø£Ù…Ø«Ù„Ø©-Ø¹Ù…Ù„ÙŠØ©)

---

## Ù†Ø¸Ø±Ø© Ø¹Ø§Ù…Ø©

Ù†Ø¸Ø§Ù… Ø§Ù„Ù…Ø±Ø§Ø³Ù„Ø© Ø§Ù„Ù…ÙˆØ­Ø¯ ÙŠÙˆÙØ±:

- âœ… Ø±Ø³Ø§Ø¦Ù„ Ù†ØµÙŠØ© ÙÙˆØ±ÙŠØ©
- âœ… Ø±Ø³Ø§Ø¦Ù„ ØµÙˆØªÙŠØ©
- âœ… Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„ØµÙˆØ±
- âœ… Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„Ù…ÙˆÙ‚Ø¹
- âœ… Ù…ÙƒØ§Ù„Ù…Ø§Øª ØµÙˆØªÙŠØ© (WebRTC)
- âœ… Ù…ÙƒØ§Ù„Ù…Ø§Øª ÙÙŠØ¯ÙŠÙˆ (WebRTC)
- âœ… Ø­Ø§Ù„Ø© Ø§Ù„ÙƒØªØ§Ø¨Ø© (typing indicator)
- âœ… Ø­Ø§Ù„Ø© Ø§Ù„ØªØ³Ù„ÙŠÙ… ÙˆØ§Ù„Ù‚Ø±Ø§Ø¡Ø©
- âœ… Ø¥Ø´Ø¹Ø§Ø±Ø§Øª Ø§Ù„Ù…ÙƒØ§Ù„Ù…Ø§Øª Ø§Ù„ÙˆØ§Ø±Ø¯Ø©

---

## Ø§Ù„Ø¨Ù†ÙŠØ© ÙˆØ§Ù„Ù…Ù„ÙØ§Øª

### Ø§Ù„Ù…Ù„ÙØ§Øª Ø§Ù„Ø£Ø³Ø§Ø³ÙŠØ©

```
apps/web/
â”œâ”€â”€ lib/messaging/
â”‚   â”œâ”€â”€ unified-messaging-system.ts    # Ø®Ø¯Ù…Ø© Ø§Ù„Ù…Ø±Ø§Ø³Ù„Ø© Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©
â”‚   â””â”€â”€ webrtc-service.ts              # Ø®Ø¯Ù…Ø© WebRTC Ù„Ù„Ù…ÙƒØ§Ù„Ù…Ø§Øª
â”œâ”€â”€ components/chat/
â”‚   â”œâ”€â”€ WhatsAppStyleChat.tsx          # ÙˆØ§Ø¬Ù‡Ø© Ø§Ù„Ø¯Ø±Ø¯Ø´Ø©
â”‚   â”œâ”€â”€ CallModal.tsx                  # Ù†Ø§ÙØ°Ø© Ø§Ù„Ù…ÙƒØ§Ù„Ù…Ø§Øª
â”‚   â””â”€â”€ index.ts                       # Ø§Ù„ØªØµØ¯ÙŠØ± Ø§Ù„Ù…ÙˆØ­Ø¯
â”œâ”€â”€ hooks/
â”‚   â””â”€â”€ useChat.ts                     # Hook Ù„Ù„Ø¯Ø±Ø¯Ø´Ø©
â””â”€â”€ pages/api/
    â”œâ”€â”€ calls/
    â”‚   â”œâ”€â”€ index.ts                   # Ø¨Ø¯Ø¡/Ø¬Ù„Ø¨ Ø§Ù„Ù…ÙƒØ§Ù„Ù…Ø§Øª
    â”‚   â””â”€â”€ [callId]/
    â”‚       â”œâ”€â”€ answer.ts              # Ø§Ù„Ø±Ø¯ Ø¹Ù„Ù‰ Ù…ÙƒØ§Ù„Ù…Ø©
    â”‚       â”œâ”€â”€ end.ts                 # Ø¥Ù†Ù‡Ø§Ø¡ Ù…ÙƒØ§Ù„Ù…Ø©
    â”‚       â””â”€â”€ decline.ts             # Ø±ÙØ¶ Ù…ÙƒØ§Ù„Ù…Ø©
    â””â”€â”€ messages/
        â””â”€â”€ upload-voice.ts            # Ø±ÙØ¹ Ø±Ø³Ø§Ù„Ø© ØµÙˆØªÙŠØ©
```

---

## Ø·Ø±ÙŠÙ‚Ø© Ø§Ù„Ø§Ø³ØªØ®Ø¯Ø§Ù…

### 1. Ø§Ø³ØªØ®Ø¯Ø§Ù… Hook Ù„Ù„Ø¯Ø±Ø¯Ø´Ø©

```tsx
import { useChat } from '@/hooks/useChat';

function ChatPage() {
  const {
    messages,
    sendTextMessage,
    sendVoiceMessage,
    sendImage,
    sendLocation,
    startVoiceCall,
    startVideoCall,
    callState,
    isTyping,
    sendTyping,
  } = useChat({
    conversationId: 'conv-123',
    // Ø£Ùˆ
    otherUserId: 'user-456',
  });

  return (
    <div>
      {/* Ø¹Ø±Ø¶ Ø§Ù„Ø±Ø³Ø§Ø¦Ù„ */}
      {messages.map((msg) => (
        <div key={msg.id}>{msg.content}</div>
      ))}

      {/* Ø¥Ø±Ø³Ø§Ù„ Ø±Ø³Ø§Ù„Ø© */}
      <button onClick={() => sendTextMessage('Ù…Ø±Ø­Ø¨Ø§Ù‹!')}>Ø¥Ø±Ø³Ø§Ù„</button>

      {/* Ø¨Ø¯Ø¡ Ù…ÙƒØ§Ù„Ù…Ø© */}
      <button onClick={startVoiceCall}>Ù…ÙƒØ§Ù„Ù…Ø© ØµÙˆØªÙŠØ©</button>
      <button onClick={startVideoCall}>Ù…ÙƒØ§Ù„Ù…Ø© ÙÙŠØ¯ÙŠÙˆ</button>
    </div>
  );
}
```

### 2. Ø§Ø³ØªØ®Ø¯Ø§Ù… Ø§Ù„Ù…ÙƒÙˆÙ†Ø§Øª Ø§Ù„Ø¬Ø§Ù‡Ø²Ø©

```tsx
import { WhatsAppStyleChat, CallModal, useChat } from '@/components/chat';

function ChatPage() {
  const {
    messages,
    sendTextMessage,
    sendVoiceMessage,
    sendImage,
    sendLocation,
    callState,
    startVoiceCall,
    startVideoCall,
    answerCall,
    endCall,
    declineCall,
    toggleMute,
    toggleVideo,
    isTyping,
    sendTyping,
  } = useChat({ conversationId: 'conv-123' });

  const otherUser = {
    id: 'user-456',
    name: 'Ø£Ø­Ù…Ø¯ Ù…Ø­Ù…Ø¯',
    profileImage: '/avatar.jpg',
    isOnline: true,
  };

  return (
    <>
      <WhatsAppStyleChat
        conversationId="conv-123"
        currentUserId="my-user-id"
        otherUser={otherUser}
        messages={messages}
        onSendMessage={sendTextMessage}
        onSendVoice={sendVoiceMessage}
        onSendImage={sendImage}
        onSendLocation={sendLocation}
        onStartVoiceCall={startVoiceCall}
        onStartVideoCall={startVideoCall}
        isTyping={isTyping}
        onTyping={sendTyping}
      />

      <CallModal
        isOpen={callState.status !== 'idle'}
        callType={callState.type || 'VOICE'}
        callStatus={callState.status}
        isIncoming={callState.isIncoming}
        remoteUser={otherUser}
        duration={callState.duration}
        isMuted={callState.isMuted}
        isVideoEnabled={callState.isVideoEnabled}
        onAnswer={answerCall}
        onDecline={declineCall}
        onEnd={endCall}
        onToggleMute={toggleMute}
        onToggleVideo={toggleVideo}
      />
    </>
  );
}
```

---

## APIs Ø§Ù„Ù…ØªØ§Ø­Ø©

### Ø§Ù„Ù…ÙƒØ§Ù„Ù…Ø§Øª

#### Ø¨Ø¯Ø¡ Ù…ÙƒØ§Ù„Ù…Ø©

```http
POST /api/calls
Content-Type: application/json

{
  "conversationId": "conv-123",
  "calleeId": "user-456",
  "type": "VOICE" | "VIDEO"
}
```

#### Ø§Ù„Ø±Ø¯ Ø¹Ù„Ù‰ Ù…ÙƒØ§Ù„Ù…Ø©

```http
POST /api/calls/[callId]/answer
```

#### Ø¥Ù†Ù‡Ø§Ø¡ Ù…ÙƒØ§Ù„Ù…Ø©

```http
POST /api/calls/[callId]/end
```

#### Ø±ÙØ¶ Ù…ÙƒØ§Ù„Ù…Ø©

```http
POST /api/calls/[callId]/decline
```

#### Ø¬Ù„Ø¨ Ø³Ø¬Ù„ Ø§Ù„Ù…ÙƒØ§Ù„Ù…Ø§Øª

```http
GET /api/calls?conversationId=conv-123&limit=20
```

### Ø§Ù„Ø±Ø³Ø§Ø¦Ù„ Ø§Ù„ØµÙˆØªÙŠØ©

```http
POST /api/messages/upload-voice
Content-Type: multipart/form-data

audio: File
conversationId: string
duration: number (seconds)
```

---

## Ø§Ù„Ù…ÙƒÙˆÙ†Ø§Øª

### WhatsAppStyleChat

ÙˆØ§Ø¬Ù‡Ø© Ø¯Ø±Ø¯Ø´Ø© Ù…ØªÙƒØ§Ù…Ù„Ø© Ø¹Ù„Ù‰ Ø·Ø±Ø§Ø² ÙˆØ§ØªØ³Ø§Ø¨.

**Props:**
| Ø§Ù„Ø®Ø§ØµÙŠØ© | Ø§Ù„Ù†ÙˆØ¹ | Ø§Ù„ÙˆØµÙ |
|---------|-------|-------|
| `conversationId` | `string` | Ù…Ø¹Ø±Ù Ø§Ù„Ù…Ø­Ø§Ø¯Ø«Ø© |
| `currentUserId` | `string` | Ù…Ø¹Ø±Ù Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… Ø§Ù„Ø­Ø§Ù„ÙŠ |
| `otherUser` | `User` | Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… Ø§Ù„Ø¢Ø®Ø± |
| `messages` | `Message[]` | Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ø±Ø³Ø§Ø¦Ù„ |
| `onSendMessage` | `function` | Ø¥Ø±Ø³Ø§Ù„ Ø±Ø³Ø§Ù„Ø© Ù†ØµÙŠØ© |
| `onSendVoice?` | `function` | Ø¥Ø±Ø³Ø§Ù„ Ø±Ø³Ø§Ù„Ø© ØµÙˆØªÙŠØ© |
| `onSendImage?` | `function` | Ø¥Ø±Ø³Ø§Ù„ ØµÙˆØ±Ø© |
| `onSendLocation?` | `function` | Ø¥Ø±Ø³Ø§Ù„ Ù…ÙˆÙ‚Ø¹ |
| `onStartVoiceCall?` | `function` | Ø¨Ø¯Ø¡ Ù…ÙƒØ§Ù„Ù…Ø© ØµÙˆØªÙŠØ© |
| `onStartVideoCall?` | `function` | Ø¨Ø¯Ø¡ Ù…ÙƒØ§Ù„Ù…Ø© ÙÙŠØ¯ÙŠÙˆ |
| `isTyping?` | `boolean` | Ø­Ø§Ù„Ø© Ø§Ù„ÙƒØªØ§Ø¨Ø© |
| `onTyping?` | `function` | Ø¥Ø±Ø³Ø§Ù„ Ø­Ø§Ù„Ø© Ø§Ù„ÙƒØªØ§Ø¨Ø© |

### CallModal

Ù†Ø§ÙØ°Ø© Ø§Ù„Ù…ÙƒØ§Ù„Ù…Ø§Øª Ø§Ù„ØµÙˆØªÙŠØ© ÙˆØ§Ù„ÙÙŠØ¯ÙŠÙˆ.

**Props:**
| Ø§Ù„Ø®Ø§ØµÙŠØ© | Ø§Ù„Ù†ÙˆØ¹ | Ø§Ù„ÙˆØµÙ |
|---------|-------|-------|
| `isOpen` | `boolean` | Ø¥Ø¸Ù‡Ø§Ø±/Ø¥Ø®ÙØ§Ø¡ Ø§Ù„Ù†Ø§ÙØ°Ø© |
| `callType` | `'VOICE' \| 'VIDEO'` | Ù†ÙˆØ¹ Ø§Ù„Ù…ÙƒØ§Ù„Ù…Ø© |
| `callStatus` | `string` | Ø­Ø§Ù„Ø© Ø§Ù„Ù…ÙƒØ§Ù„Ù…Ø© |
| `isIncoming` | `boolean` | Ù‡Ù„ Ù…ÙƒØ§Ù„Ù…Ø© ÙˆØ§Ø±Ø¯Ø©ØŸ |
| `remoteUser` | `User` | Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø·Ø±Ù Ø§Ù„Ø¢Ø®Ø± |
| `duration` | `number` | Ù…Ø¯Ø© Ø§Ù„Ù…ÙƒØ§Ù„Ù…Ø© Ø¨Ø§Ù„Ø«ÙˆØ§Ù†ÙŠ |
| `isMuted` | `boolean` | Ø­Ø§Ù„Ø© ÙƒØªÙ… Ø§Ù„ØµÙˆØª |
| `isVideoEnabled` | `boolean` | Ø­Ø§Ù„Ø© Ø§Ù„ÙÙŠØ¯ÙŠÙˆ |
| `onAnswer` | `function` | Ø§Ù„Ø±Ø¯ Ø¹Ù„Ù‰ Ø§Ù„Ù…ÙƒØ§Ù„Ù…Ø© |
| `onDecline` | `function` | Ø±ÙØ¶ Ø§Ù„Ù…ÙƒØ§Ù„Ù…Ø© |
| `onEnd` | `function` | Ø¥Ù†Ù‡Ø§Ø¡ Ø§Ù„Ù…ÙƒØ§Ù„Ù…Ø© |
| `onToggleMute` | `function` | ÙƒØªÙ…/Ø¥Ù„ØºØ§Ø¡ ÙƒØªÙ… |
| `onToggleVideo` | `function` | ØªØ´ØºÙŠÙ„/Ø¥ÙŠÙ‚Ø§Ù Ø§Ù„ÙÙŠØ¯ÙŠÙˆ |

---

## Ø§Ù„Ø®Ø¯Ù…Ø§Øª

### messagingSystem

Ø®Ø¯Ù…Ø© Ø§Ù„Ù…Ø±Ø§Ø³Ù„Ø© Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ© (Singleton).

```typescript
import { messagingSystem } from '@/lib/messaging/unified-messaging-system';

// ØªÙ‡ÙŠØ¦Ø©
messagingSystem.initialize(userId, token);

// Ø§Ù„Ù…Ø­Ø§Ø¯Ø«Ø§Øª
await messagingSystem.getConversations();
await messagingSystem.getConversation(conversationId);
await messagingSystem.getOrCreateConversation(otherUserId);

// Ø§Ù„Ø±Ø³Ø§Ø¦Ù„
await messagingSystem.getMessages(conversationId);
await messagingSystem.sendTextMessage(conversationId, text);
await messagingSystem.sendVoiceMessage(conversationId, blob, duration);
await messagingSystem.sendImage(conversationId, file);
await messagingSystem.sendLocation(conversationId, lat, lng, address);

// Ø§Ù„ÙƒØªØ§Ø¨Ø©
messagingSystem.sendTyping(conversationId);
messagingSystem.stopTyping(conversationId);

// Ø§Ù„Ù‚Ø±Ø§Ø¡Ø©
await messagingSystem.markAsRead(conversationId);

// Ø§Ù„Ù…ÙƒØ§Ù„Ù…Ø§Øª
await messagingSystem.startCall(conversationId, calleeId, type);
await messagingSystem.answerCall(callId);
await messagingSystem.endCall(callId);
await messagingSystem.declineCall(callId);

// Ø§Ù„Ø£Ø­Ø¯Ø§Ø«
messagingSystem.on('message:new', handler);
messagingSystem.on('call:incoming', handler);
messagingSystem.on('typing', handler);
```

### webRTCService

Ø®Ø¯Ù…Ø© WebRTC Ù„Ù„Ù…ÙƒØ§Ù„Ù…Ø§Øª (Singleton).

```typescript
import { webRTCService } from '@/lib/messaging/webrtc-service';

// Ø¨Ø¯Ø¡ Ù…ÙƒØ§Ù„Ù…Ø©
await webRTCService.startCall(callId, remoteUserId, userName, 'VIDEO');

// Ø§Ù„Ø±Ø¯ Ø¹Ù„Ù‰ Ù…ÙƒØ§Ù„Ù…Ø©
await webRTCService.answerCall(offer);

// Ø¥Ù†Ù‡Ø§Ø¡/Ø±ÙØ¶
webRTCService.endCall();
webRTCService.declineCall();

// Ø§Ù„ØªØ­ÙƒÙ…
webRTCService.toggleMute();
webRTCService.toggleVideo();
await webRTCService.switchCamera();

// Ø§Ù„Ø­Ø§Ù„Ø©
webRTCService.getState();
webRTCService.isInCall();

// Ø§Ù„Ø¨Ø«
webRTCService.getLocalMediaStream();
webRTCService.getRemoteMediaStream();

// Ø§Ù„Ø£Ø­Ø¯Ø§Ø«
webRTCService.on('incoming', handler);
webRTCService.on('connected', handler);
webRTCService.on('ended', handler);
webRTCService.on('remoteStream', handler);
```

---

## Ù‚Ø§Ø¹Ø¯Ø© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª

### Ø¬Ø¯ÙˆÙ„ Ø§Ù„Ù…ÙƒØ§Ù„Ù…Ø§Øª (calls)

```prisma
model calls {
  id             String     @id @default(cuid())
  conversationId String
  callerId       String
  calleeId       String
  type           CallType   @default(VOICE)
  status         CallStatus @default(RINGING)
  startedAt      DateTime?
  endedAt        DateTime?
  duration       Int?
  missedReason   String?
  metadata       Json?
  createdAt      DateTime   @default(now())
  updatedAt      DateTime   @updatedAt

  conversation   conversations @relation(...)
  caller         users         @relation("caller", ...)
  callee         users         @relation("callee", ...)
}
```

### Ø£Ù†ÙˆØ§Ø¹ Ø§Ù„Ø±Ø³Ø§Ø¦Ù„ Ø§Ù„Ø¬Ø¯ÙŠØ¯Ø©

```prisma
enum MessageType {
  TEXT
  IMAGE
  FILE
  LOCATION
  VOICE
  VIDEO         # Ø¬Ø¯ÙŠØ¯
  BID
  CALL_STARTED  # Ø¬Ø¯ÙŠØ¯
  CALL_ENDED    # Ø¬Ø¯ÙŠØ¯
  CALL_MISSED   # Ø¬Ø¯ÙŠØ¯
}

enum CallType {
  VOICE
  VIDEO
}

enum CallStatus {
  RINGING
  ANSWERED
  ENDED
  MISSED
  DECLINED
  BUSY
  FAILED
}
```

---

## Ø£Ù…Ø«Ù„Ø© Ø¹Ù…Ù„ÙŠØ©

### Ù…Ø«Ø§Ù„ 1: ØµÙØ­Ø© Ø¯Ø±Ø¯Ø´Ø© ÙƒØ§Ù…Ù„Ø©

```tsx
// pages/chat/[conversationId].tsx
import { useRouter } from 'next/router';
import { WhatsAppStyleChat, CallModal, useChat } from '@/components/chat';
import { webRTCService } from '@/lib/messaging/webrtc-service';
import useAuth from '@/hooks/useAuth';

export default function ChatPage() {
  const router = useRouter();
  const { conversationId } = router.query;
  const { user } = useAuth();

  const chat = useChat({
    conversationId: conversationId as string,
  });

  if (!chat.conversation) return <div>Ø¬Ø§Ø±ÙŠ Ø§Ù„ØªØ­Ù…ÙŠÙ„...</div>;

  const otherUser = chat.conversation.participants.find((p) => p.id !== user?.id);

  return (
    <div className="h-screen">
      <WhatsAppStyleChat
        conversationId={chat.conversation.id}
        currentUserId={user?.id || ''}
        otherUser={otherUser || { id: '', name: 'Ù…Ø³ØªØ®Ø¯Ù…' }}
        messages={chat.messages}
        onSendMessage={async (text) => chat.sendTextMessage(text)}
        onSendVoice={chat.sendVoiceMessage}
        onSendImage={chat.sendImage}
        onSendLocation={chat.sendLocation}
        onStartVoiceCall={chat.startVoiceCall}
        onStartVideoCall={chat.startVideoCall}
        isTyping={chat.isTyping}
        onTyping={chat.sendTyping}
        onBack={() => router.back()}
      />

      <CallModal
        isOpen={chat.callState.status !== 'idle'}
        callType={chat.callState.type || 'VOICE'}
        callStatus={chat.callState.status}
        isIncoming={chat.callState.isIncoming}
        remoteUser={otherUser || { id: '', name: '' }}
        duration={chat.callState.duration}
        localStream={webRTCService.getLocalMediaStream()}
        remoteStream={webRTCService.getRemoteMediaStream()}
        isMuted={chat.callState.isMuted}
        isVideoEnabled={chat.callState.isVideoEnabled}
        onAnswer={chat.answerCall}
        onDecline={chat.declineCall}
        onEnd={chat.endCall}
        onToggleMute={chat.toggleMute}
        onToggleVideo={chat.toggleVideo}
      />
    </div>
  );
}
```

### Ù…Ø«Ø§Ù„ 2: Ø²Ø± Ø¨Ø¯Ø¡ Ø¯Ø±Ø¯Ø´Ø© Ù…Ù† Ø£ÙŠ Ù…ÙƒØ§Ù†

```tsx
import { useRouter } from 'next/router';

function ContactButton({ userId, userName }: { userId: string; userName: string }) {
  const router = useRouter();

  const handleMessage = () => {
    // Ø§Ù„ØªÙˆØ¬ÙŠÙ‡ Ù„ØµÙØ­Ø© Ø§Ù„Ø±Ø³Ø§Ø¦Ù„ Ù…Ø¹ Ù…Ø¹Ø±Ù Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…
    router.push(`/messages?chat=${userId}&name=${encodeURIComponent(userName)}`);
  };

  return (
    <button
      onClick={handleMessage}
      className="flex items-center gap-2 rounded-lg bg-emerald-500 px-4 py-2 text-white hover:bg-emerald-600"
    >
      <ChatBubbleIcon className="h-5 w-5" />
      <span>Ù…Ø±Ø§Ø³Ù„Ø©</span>
    </button>
  );
}
```

---

## ğŸ”’ Ø§Ù„Ø£Ù…Ø§Ù†

- Ø¬Ù…ÙŠØ¹ APIs Ù…Ø­Ù…ÙŠØ© Ø¨Ù…ØµØ§Ø¯Ù‚Ø© JWT
- Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø§Ù„Ù…Ø´Ø§Ø±ÙƒØ© ÙÙŠ Ø§Ù„Ù…Ø­Ø§Ø¯Ø«Ø© Ù‚Ø¨Ù„ Ø§Ù„Ø¥Ø±Ø³Ø§Ù„
- Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† ØµØ§Ø­Ø¨ Ø§Ù„Ù…ÙƒØ§Ù„Ù…Ø© Ù‚Ø¨Ù„ Ø§Ù„Ø±Ø¯/Ø§Ù„Ø¥Ù†Ù‡Ø§Ø¡
- ØªØ´ÙÙŠØ± WebRTC Ù„Ù„Ù…ÙƒØ§Ù„Ù…Ø§Øª

---

## ğŸš€ Ø§Ù„Ø®Ø·ÙˆØ§Øª Ø§Ù„Ù‚Ø§Ø¯Ù…Ø©

1. [ ] Ø¥Ø¶Ø§ÙØ© Ø¯Ø¹Ù… Ø§Ù„Ù…Ø¬Ù…ÙˆØ¹Ø§Øª
2. [ ] Ø¥Ø¶Ø§ÙØ© Ø¥Ø´Ø¹Ø§Ø±Ø§Øª Push Ù„Ù„Ù…ÙƒØ§Ù„Ù…Ø§Øª
3. [ ] Ø¥Ø¶Ø§ÙØ© ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ù…ÙƒØ§Ù„Ù…Ø§Øª
4. [ ] Ø¥Ø¶Ø§ÙØ© Ù…Ø´Ø§Ø±ÙƒØ© Ø§Ù„Ø´Ø§Ø´Ø©
5. [ ] ØªØ­Ø³ÙŠÙ† Ø¬ÙˆØ¯Ø© Ø§Ù„ØµÙˆØª ÙˆØ§Ù„ÙÙŠØ¯ÙŠÙˆ

---

## ğŸ“ Ø§Ù„Ø¯Ø¹Ù…

Ù„Ù„Ù…Ø³Ø§Ø¹Ø¯Ø© Ø£Ùˆ Ø§Ù„Ø¥Ø¨Ù„Ø§Øº Ø¹Ù† Ù…Ø´Ø§ÙƒÙ„ØŒ ØªÙˆØ§ØµÙ„ Ù…Ø¹ ÙØ±ÙŠÙ‚ Ø§Ù„ØªØ·ÙˆÙŠØ±.
